{
  "id": "${info.app.name}-${info.app.version}",
  "name": "${info.app.name}",
  "provides": [
    {
      "id": "servint",
      "version": "${info.app.minorVersion}",
      "handlers" : [
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/settings*",
          "permissionsRequired": [ "servint.settings.get" ]
        },
        {
          "methods": [ "POST" ],
          "pathPattern": "/servint/settings*",
          "permissionsRequired": [ "servint.settings.post" ]
        },
        {
          "methods": [ "PUT" ],
          "pathPattern": "/servint/settings*",
          "permissionsRequired": [ "servint.settings.put" ]
        },
        {
          "methods": [ "DELETE" ],
          "pathPattern": "/servint/settings*",
          "permissionsRequired": [ "servint.settings.delete" ]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/refdata*",
          "permissionsRequired": [ "servint.refdata.get" ]
        },
        {
          "methods": [ "POST" ],
          "pathPattern": "/servint/refdata*",
          "permissionsRequired": [ "servint.refdata.post" ]
        },
        {
          "methods": [ "PUT" ],
          "pathPattern": "/servint/refdata*",
          "permissionsRequired": [ "servint.refdata.put" ]
        },
        {
          "methods": [ "DELETE" ],
          "pathPattern": "/servint/refdata*",
          "permissionsRequired": [ "servint.refdata.delete" ]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/dashboard",
          "permissionsRequired": ["servint.dashboards.collection.get"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/dashboard/my-dashboards",
          "permissionsRequired": ["servint.dashboards.user.get"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/dashboard/{id}",
          "permissionsRequired": ["servint.dashboards.item.get"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "POST" ],
          "pathPattern": "/servint/dashboard",
          "permissionsRequired": ["servint.dashboards.item.post"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "PUT" ],
          "pathPattern": "/servint/dashboard/{id}",
          "permissionsRequired": ["servint.dashboards.item.put"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "DELETE" ],
          "pathPattern": "/servint/dashboard/{id}",
          "permissionsRequired": ["servint.dashboards.item.delete"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/widgets/definitions/global",
          "permissionsRequired": ["servint.widgetDefinitions.collection.global.get"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/widgets/definitions",
          "permissionsRequired": ["servint.widgetDefinitions.collection.get"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/widgets/definitions/{id}",
          "permissionsRequired": ["servint.widgetDefinitions.item.get"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/widgets/instances",
          "permissionsRequired": ["servint.widgetInstances.collection.get"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/widgets/instances/my-widgets",
          "permissionsRequired": ["servint.widgetInstances.user.get"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/widgets/instances/{id}",
          "permissionsRequired": ["servint.widgetInstances.item.get"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "PUT" ],
          "pathPattern": "/servint/widgets/instances/{id}",
          "permissionsRequired": ["servint.widgetInstances.item.put"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "POST" ],
          "pathPattern": "/servint/widgets/instances",
          "permissionsRequired": ["servint.widgetInstances.item.post"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "DELETE" ],
          "pathPattern": "/servint/widgets/instances/{id}",
          "permissionsRequired": ["servint.widgetInstances.item.delete"],
          "permissionsDesired":["servint.dashboards.admin"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/widgets/types",
          "permissionsRequired": ["servint.widgetTypes.collection.get"]
        },
        {
          "methods": ["GET"],
          "pathPattern": "/servint/admin/*",
          "permissionsRequired": ["servint.admin.action"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/logs",
          "permissionsRequired": ["servint.logs.collection.get"]
        },
        {
          "methods": [ "POST" ],
          "pathPattern": "/servint/logs",
          "permissionsRequired": ["servint.logs.item.post"]
        },
        {
          "methods": [ "GET" ],
          "pathPattern": "/servint/logs/{id}",
          "permissionsRequired": ["servint.logs.item.get"]
        },
        {
          "methods": [ "PUT" ],
          "pathPattern": "/servint/logs/{id}",
          "permissionsRequired": ["servint.logs.item.put"]
        },
        {
          "methods": [ "DELETE" ],
          "pathPattern": "/servint/logs/{id}",
          "permissionsRequired": ["servint.logs.item.delete"]
        }
      ]
    },
    {
      "id": "dashboard",
      "interfaceType": "multiple",
      "version": "1.0",
      "handlers": [
        {
          "methods": [ "GET" ],
          "pathPattern": "/dashboard/definitions",
          "permissionsRequired": []
        }
      ]
    },
    {
      "id": "_tenant",
      "version": "1.2",
      "interfaceType" : "system",
      "handlers": [
        {
          "permissionsRequired" : [],
          "methods": ["POST", "DELETE"],
          "pathPattern": "/_/tenant"
        }, {
         "permissionsRequired" : [],
         "methods" : [ "POST" ],
         "pathPattern" : "/_/tenant/disable"
        }
      ]
    }
  ],
  "permissionSets": [
    {
      "permissionName": "servint.settings.get",
      "displayName": "settings get",
      "description": "get settings",
      "visible": false
    }, 
    {
      "permissionName": "servint.settings.post",
      "displayName": "settings post",
      "description": "post settings",
      "visible": false
    }, 
    {
      "permissionName": "servint.settings.put",
      "displayName": "settings put",
      "description": "put settings",
      "visible": false
    }, {
      "permissionName": "servint.settings.delete",
      "displayName": "settings delete",
      "description": "delete settings",
      "visible": false
    },
    {
      "permissionName": "servint.settings.read",
      "displayName": "settings read",
      "description": "read settings",
      "visible": false,
      "subPermissions": [
          "servint.settings.get"
      ]
    },
    {
      "permissionName": "servint.settings.write",
      "displayName": "settings write",
      "description": "write settings",
      "visible": false,
      "subPermissions": [
          "servint.settings.read",
          "servint.settings.post",
          "servint.settings.put",
          "servint.settings.delete"
      ]
    },
    {
      "permissionName": "servint.refdata.get",
      "displayName": "refdata get",
      "description": "get refdata",
      "visible": false
    }, 
    {
      "permissionName": "servint.refdata.post",
      "displayName": "refdata post",
      "description": "post refdata",
      "visible": false
    }, 
    {
      "permissionName": "servint.refdata.put",
      "displayName": "refdata put",
      "description": "put refdata",
      "visible": false
    }, {
      "permissionName": "servint.refdata.delete",
      "displayName": "refdata delete",
      "description": "delete refdata",
      "visible": false
    },
    {
      "permissionName": "servint.refdata.read",
      "displayName": "refdata read",
      "description": "read refdata",
      "visible": false,
      "subPermissions": [
          "servint.refdata.get"
      ]
    },
    {
      "permissionName": "servint.refdata.write",
      "displayName": "refdata write",
      "description": "write refdata",
      "visible": false,
      "subPermissions": [
          "servint.refdata.read",
          "servint.refdata.post",
          "servint.refdata.put",
          "servint.refdata.delete"
      ]
    },
    {
      "permissionName": "servint.dashboards.user.get",
      "displayName": "Dashboard user collection get",
      "description": "Get a collection of dashboards for a user"
    },
    {
      "permissionName": "servint.dashboards.item.get",
      "displayName": "Dashboard user item get",
      "description": "Get a dashboard item for a user"
    },
    {
      "permissionName": "servint.dashboards.view",
      "subPermissions": [
        "servint.dashboards.user.get",
        "servint.dashboards.item.get"
      ]
    },
    {
      "permissionName": "servint.dashboards.item.post",
      "displayName": "Dashboard user item post",
      "description": "Post a dashboard item for a user"
    },
    {
      "permissionName": "servint.dashboards.item.put",
      "displayName": "Dashboard user item put",
      "description": "Put a dashboard item for a user"
    },
    {
      "permissionName": "servint.widgetTypes.collection.get",
      "displayName": "WidgetTypes collection get",
      "description": "Get a collection of all WidgetTypes"
    },
    {
      "permissionName": "servint.widgetDefinitions.collection.global.get",
      "displayName": "WidgetDefinition collection global get",
      "description": "Get list of all WidgetDefinitions from all implementing modules"
    },
    
    {
      "permissionName": "servint.widgetDefinitions.collection.get",
      "displayName": "WidgetDefinition collection get",
      "description": "Get a collection of all WidgetDefinitions"
    },
    {
      "permissionName": "servint.widgetDefinitions.item.get",
      "displayName": "WidgetDefinition item get",
      "description": "Get a WidgetDefinition item"
    },
    {
      "permissionName": "servint.widgetInstances.user.get",
      "displayName": "Widget instances user collection get",
      "description": "Get a collection of WidgetInstances for a user"
    },
    {
      "permissionName": "servint.widgetInstances.collection.get",
      "displayName": "WidgetInstance collection get ",
      "description": "Get a collection of WidgetInstance items"
    },
    {
      "permissionName": "servint.widgetInstances.item.get",
      "displayName": "WidgetInstance item post",
      "description": "Get a WidgetInstance item"
    },
    {
      "permissionName": "servint.widgetInstances.item.post",
      "displayName": "WidgetInstance item post",
      "description": "Post a WidgetInstance item"
    },
    {
      "permissionName": "servint.widgetInstances.item.put",
      "displayName": "WidgetInstance item put",
      "description": "Put a WidgetInstance item"
    },
    {
      "permissionName": "servint.widgetInstances.item.delete",
      "displayName": "WidgetInstance item delete",
      "description": "Delete a WidgetInstance item"
    },
    {
      "permissionName": "servint.widget.view",
      "displayName": "Widget view",
      "description": "Allow user to view their own widgets",
      "subPermissions": [
        "servint.widgetTypes.collection.get",
        "servint.widgetDefinitions.collection.global.get",
        "servint.widgetInstances.item.get",
        "servint.widgetInstances.user.get"
      ]
    },
    {
      "permissionName": "servint.widget.create",
      "displayName": "Widget creation",
      "description": "Allow user to access widgetDefinitions and post widgetInstances",
      "subPermissions": [
        "servint.widget.view",
        "servint.widgetInstances.item.post"
      ]
    },
    {
      "permissionName": "servint.widget.edit",
      "displayName": "Widget editing",
      "description": "Allow user to edit and delete widgetInstances",
      "subPermissions": [
        "servint.widgetInstances.item.put",
        "servint.widgetInstances.item.delete"
      ]
    },
    {
      "permissionName": "servint.dashboards.edit",
      "displayName": "Dashboards edit",
      "description": "Allow user to create, edit and add widgets to dashboards",
      "subPermissions": [
        "servint.dashboards.view",
        "servint.dashboards.item.post",
        "servint.dashboards.item.put",
        "servint.widget.create",
        "servint.widget.edit"
      ]
    },
    {
      "permissionName": "servint.dashboards.item.delete",
      "displayName": "Dashboard user item delete",
      "description": "Delete a dashboard item for a user"
    },
    {
      "permissionName": "servint.dashboards.manage",
      "displayName": "Dashboards manage",
      "description": "Dashboard edit and delete",
      "subPermissions": [
        "servint.dashboards.edit",
        "servint.dashboards.item.delete"
      ]
    },
    {
      "permissionName": "servint.dashboards.collection.get",
      "displayName": "Dashboard collection get",
      "description": "Get all dashboards"
    },
    {
      "permissionName": "servint.widgetDefinitions.manage",
      "displayName": "Manage local WidgetDefinitions admin",
      "description": "Permissions to manage the local store of tenant defined WidgetDefinitions",
      "subPermissions": [
        "servint.widgetDefinitions.collection.get",
        "servint.widgetDefinitions.item.get"
      ]
    },
    {
      "permissionName": "servint.logs.collection.get",
      "displayName": "Logs collection get",
      "description": "Get all 'Log' objects"
    },
    {
      "permissionName": "servint.logs.item.get",
      "displayName": "Logs item get",
      "description": "Get a 'Log' object"
    },
    {
      "permissionName": "servint.logs.item.post",
      "displayName": "Logs item get",
      "description": "Post a 'Log' object"
    },
    {
      "permissionName": "servint.logs.item.put",
      "displayName": "Logs item get",
      "description": "Put a 'Log' object"
    },
    {
      "permissionName": "servint.logs.item.delete",
      "displayName": "Logs item get",
      "description": "Delete a 'Log' object"
    },
    {
      "permissionName": "servint.logs.view",
      "displayName": "Logs view",
      "description": "View 'Log' objects",
      "subPermissions": [
        "servint.logs.collection.get",
        "servint.logs.item.get"
      ]
    },
    {
      "permissionName": "servint.logs.edit",
      "displayName": "Logs edit",
      "description": "View and edit 'Log' objects",
      "subPermissions": [
        "servint.logs.view",
        "servint.logs.item.post",
        "servint.logs.item.put"
      ]
    },
    {
      "permissionName": "servint.logs.manage",
      "displayName": "Logs manage",
      "description": "View, edit and delete 'Log' objects",
      "subPermissions": [
        "servint.logs.edit",
        "servint.logs.item.delete"
      ]
    },
    {
      "permissionName": "servint.admin.action",
      "displayName": "Administrator actions",
      "description": "Allow administrator to perform actions"
    },
    {
      "permissionName": "servint.dashboards.admin",
      "displayName": "Dashboard admin",
      "description": "Allow admin access to dashboards",
      "subPermissions": [
        "servint.widgetInstances.collection.get",
        "servint.dashboards.collection.get",
        "servint.dashboards.manage",
        "servint.admin.action",
        "servint.widgetDefinitions.manage",
        "servint.logs.manage"
      ]
    }
  ],
  "launchDescriptor": {
    "dockerImage": "${info.app.name}:${info.app.version}",
    "dockerArgs": {
      "HostConfig": { "PortBindings": { "8080/tcp":  [{ "HostPort": "%p" }] } }
    },
    "env": [
      { "name": "JAVA_OPTIONS", "value": "-server -XX:+UseContainerSupport -XX:MaxRAMPercentage=55.0 -XX:+PrintFlagsFinal" }
    ],
    "dockerPull" : false
  }
}
